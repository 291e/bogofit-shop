# ğŸ·ï¸ ë¸Œëœë“œ íŒŒíŠ¸ë„ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

BOGOFIT Shopì˜ ë¸Œëœë“œ íŒŒíŠ¸ë„ˆ ê´€ë¦¬ ì‹œìŠ¤í…œì€ **ì…ì  ë¸Œëœë“œ**ë¥¼ ìœ„í•œ ì „ìš© ê´€ë¦¬ ë„êµ¬ì…ë‹ˆë‹¤. ìƒí’ˆ ê´€ë¦¬, ì£¼ë¬¸ ì²˜ë¦¬, ì •ì‚° ê´€ë¦¬, í†µê³„ ë¶„ì„ ë“± ë¸Œëœë“œ ìš´ì˜ì— í•„ìš”í•œ í•µì‹¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥ (ìµœì‹  ë²„ì „)

### 1. **ğŸ“Š ëŒ€ì‹œë³´ë“œ**

- ì‹¤ì‹œê°„ ë§¤ì¶œ ë° ì£¼ë¬¸ í†µê³„
- ë¸Œëœë“œë³„ ì„±ê³¼ ì§€í‘œ
- ìµœê·¼ ì£¼ë¬¸ í˜„í™©
- ë¹ ë¥¸ ì•¡ì…˜ ë²„íŠ¼

### 2. **ğŸ›ï¸ ìƒí’ˆ ê´€ë¦¬**

- ìƒí’ˆ ë“±ë¡, ìˆ˜ì •, ì‚­ì œ
- ì¬ê³  ê´€ë¦¬ ë° ì•Œë¦¼
- ìƒí’ˆ ì˜µì…˜ ê´€ë¦¬ (ìƒ‰ìƒ, ì‚¬ì´ì¦ˆ ë“±)
- Tiptap ì—ë””í„°ë¥¼ í†µí•œ ìƒì„¸ ì„¤ëª…

### 3. **ğŸ“¦ ì£¼ë¬¸ ê´€ë¦¬**

- ë¸Œëœë“œë³„ ì£¼ë¬¸ ëª©ë¡
- ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬ (ì ‘ìˆ˜ â†’ ì¤€ë¹„ â†’ ë°°ì†¡ â†’ ì™„ë£Œ)
- ë°°ì†¡ ê´€ë¦¬
- ë°˜í’ˆ/í™˜ë¶ˆ ì²˜ë¦¬

### 4. **ğŸ“ˆ í†µê³„ ë° ë¶„ì„**

- **ë§¤ì¶œ ë¶„ì„**: ê¸°ê°„ë³„ ë§¤ì¶œ, ì„±ì¥ë¥ , ëª©í‘œ ëŒ€ë¹„ ì‹¤ì 
- **ìƒí’ˆ ë¶„ì„**: ë² ìŠ¤íŠ¸ì…€ëŸ¬, ì¬ê³  íšŒì „ìœ¨, ìˆ˜ìµë¥ 

### 5. **ğŸ’° ì •ì‚° ê´€ë¦¬**

- ì›”ë³„ ì •ì‚° í˜„í™©
- ìˆ˜ìˆ˜ë£Œ ê³„ì‚° ë° í™•ì¸
- ì •ì‚° ì‹ ì²­ ë° ì²˜ë¦¬ ìƒíƒœ
- ì •ì‚° ê³„ì¢Œ ê´€ë¦¬

### 6. **ğŸ·ï¸ ë¸Œëœë“œ ì„¤ì •**

- ë¸Œëœë“œëª… ë° ë¡œê³  ê´€ë¦¬
- ë¸Œëœë“œ ì†Œê°œ í¸ì§‘
- ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°

## ğŸ—‘ï¸ ì œê±°ëœ ê¸°ëŠ¥

- âŒ **ë§¤ì¥ ê´€ë¦¬**: ì‡¼í•‘ëª°ì—ì„œ í†µí•© ê´€ë¦¬
- âŒ **ê³ ê° ê´€ë¦¬**: ê°œì¸ì •ë³´ ë³´í˜¸ ë° ì‡¼í•‘ëª° í†µí•© ê´€ë¦¬
- âŒ **ê³ ê° ë¶„ì„**: ë¸Œëœë“œëŠ” ë§¤ì¶œ ì¤‘ì‹¬ ë¶„ì„ë§Œ ì œê³µ
- âŒ **ë³µì¡í•œ ì„¤ì •**: API ê´€ë¦¬, ì•Œë¦¼ ì„¤ì • ë“± ê³ ê¸‰ ê¸°ëŠ¥

## ğŸš€ ì‹œì‘í•˜ê¸°

### 1. ì ‘ê·¼ ê¶Œí•œ

ë¸Œëœë“œ íŒŒíŠ¸ë„ˆ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ë ¤ë©´:

1. **ë¸Œëœë“œ ê³„ì • í•„ìš”**: `user.isBusiness = true`
2. **ë¡œê·¸ì¸ ìƒíƒœ**: ìœ íš¨í•œ ì¸ì¦ í† í° í•„ìš”
3. **ë¸Œëœë“œ ë“±ë¡**: `Brand` í…Œì´ë¸”ì— ë“±ë¡ëœ ë¸Œëœë“œ
4. **ìŠ¹ì¸ ìƒíƒœ**: `brand.status = 'APPROVED'`

### 2. ì ‘ê·¼ ê²½ë¡œ

```
https://your-domain.com/business
```

## ğŸ“ ì‹œìŠ¤í…œ êµ¬ì¡° (ìµœì‹ )

```
src/
â”œâ”€â”€ app/(Business)/                 # ë¸Œëœë“œ ë¼ìš°íŠ¸ ê·¸ë£¹
â”‚   â”œâ”€â”€ layout.tsx                 # ë¸Œëœë“œ ì „ìš© ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ business/
â”‚       â”œâ”€â”€ page.tsx               # ëŒ€ì‹œë³´ë“œ
â”‚       â”œâ”€â”€ products/
â”‚       â”‚   â”œâ”€â”€ page.tsx           # ìƒí’ˆ ëª©ë¡
â”‚       â”‚   â”œâ”€â”€ new/
â”‚       â”‚   â”‚   â””â”€â”€ page.tsx       # ìƒí’ˆ ë“±ë¡ (Tiptap ì—ë””í„°)
â”‚       â”‚   â””â”€â”€ inventory/
â”‚       â”‚       â””â”€â”€ page.tsx       # ì¬ê³  ê´€ë¦¬
â”‚       â”œâ”€â”€ orders/
â”‚       â”‚   â”œâ”€â”€ page.tsx           # ì£¼ë¬¸ ëª©ë¡ (ë¯¸êµ¬í˜„)
â”‚       â”œâ”€â”€ shipping/
â”‚       â”‚   â””â”€â”€ page.tsx           # ë°°ì†¡ ê´€ë¦¬ (ë¯¸êµ¬í˜„)
â”‚       â”œâ”€â”€ refunds/
â”‚       â”‚   â””â”€â”€ page.tsx           # ë°˜í’ˆ/í™˜ë¶ˆ (ë¯¸êµ¬í˜„)
â”‚       â”œâ”€â”€ analytics/
â”‚       â”‚   â”œâ”€â”€ sales/
â”‚       â”‚   â”‚   â””â”€â”€ page.tsx       # ë§¤ì¶œ ë¶„ì„
â”‚       â”‚   â””â”€â”€ products/
â”‚       â”‚       â””â”€â”€ page.tsx       # ìƒí’ˆ ë¶„ì„
â”‚       â”œâ”€â”€ settlement/
â”‚       â”‚   â””â”€â”€ page.tsx           # ì •ì‚° ê´€ë¦¬
â”‚       â””â”€â”€ settings/
â”‚           â””â”€â”€ brand/
â”‚               â””â”€â”€ page.tsx       # ë¸Œëœë“œ ì„¤ì •
â”œâ”€â”€ components/business/            # ë¸Œëœë“œ ì „ìš© ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ BusinessSidebar.tsx        # ì‚¬ì´ë“œë°” (ì—…ë°ì´íŠ¸ë¨)
â”‚   â”œâ”€â”€ BusinessRouteGuard.tsx     # ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬
â”‚   â””â”€â”€ TiptapEditor.tsx           # ìƒí’ˆ ìƒì„¸ ì—ë””í„°
â”œâ”€â”€ contents/Business/              # ë¸Œëœë“œ ë°ì´í„° ì„¼í„°
â”‚   â”œâ”€â”€ menuItems.ts               # ì‚¬ì´ë“œë°” ë©”ë‰´ (ì—…ë°ì´íŠ¸ë¨)
â”‚   â”œâ”€â”€ analyticsData.ts           # ë¶„ì„ ë°ì´í„° (ê³ ê° ë°ì´í„° ì œê±°)
â”‚   â”œâ”€â”€ settlementData.ts          # ì •ì‚° ë°ì´í„° (ì‹ ê·œ)
â”‚   â”œâ”€â”€ inventoryData.ts           # ì¬ê³  ë°ì´í„°
â”‚   â”œâ”€â”€ shippingData.ts            # ë°°ì†¡ ë°ì´í„°
â”‚   â”œâ”€â”€ refundData.ts              # í™˜ë¶ˆ ë°ì´í„°
â”‚   â””â”€â”€ productFormData.ts         # ìƒí’ˆ í¼ ë°ì´í„°
â””â”€â”€ app/api/business/              # ë¸Œëœë“œ API (ë¯¸êµ¬í˜„)
    â”œâ”€â”€ route.ts                   # ë¸Œëœë“œ ì •ë³´ CRUD
    â”œâ”€â”€ products/route.ts          # ìƒí’ˆ ê´€ë¦¬
    â”œâ”€â”€ orders/route.ts            # ì£¼ë¬¸ ê´€ë¦¬
    â”œâ”€â”€ settlement/route.ts        # ì •ì‚° ê´€ë¦¬
    â””â”€â”€ analytics/route.ts         # í†µê³„ ë°ì´í„°
```

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ë¶„ì„ ë° ê°œì„  ë°©ì•ˆ

### ğŸ“Š í˜„ì¬ DB êµ¬ì¡° ë¶„ì„

#### âœ… ê¸°ì¡´ ìœ ì§€ í…Œì´ë¸”

```sql
-- ì‚¬ìš©ì ê´€ë¦¬
User (id, userId, isBusiness, email, name, phoneNumber, ...)
Provider (ì†Œì…œ ë¡œê·¸ì¸)
Address (ë°°ì†¡ì§€ ê´€ë¦¬)

-- ìƒí’ˆ ê´€ë¦¬
Product (id, title, price, category, imageUrl, badge, ...)
ProductVariant (ì˜µì…˜ ê´€ë¦¬: ìƒ‰ìƒ, ì‚¬ì´ì¦ˆ ë“±)

-- ì£¼ë¬¸ ê´€ë¦¬
Order (ì£¼ë¬¸ ì •ë³´)
OrderItem (ì£¼ë¬¸ ìƒí’ˆ)
Payment (ê²°ì œ ì •ë³´)

-- ê¸°íƒ€
Review, Coupon, Event, Notice, Faq
```

#### âŒ ìˆ˜ì • í•„ìš”í•œ ê¸°ì¡´ í…Œì´ë¸”

**1. Product í…Œì´ë¸”**

```sql
-- í˜„ì¬: storeName (String) - í•˜ë“œì½”ë”©ëœ ë§¤ì¥ëª…
-- ê°œì„ : brandId (Int) - Brand í…Œì´ë¸”ê³¼ ì™¸ë˜í‚¤ ì—°ê²°

-- ì¶”ê°€ í•„ìš” í•„ë“œ
detailedDescription  String?    -- Tiptap ì—ë””í„° HTML ì¶œë ¥
status              ProductStatus @default(PENDING)  -- ìŠ¹ì¸ ìƒíƒœ
brandId             Int                              -- ë¸Œëœë“œ ì—°ê²°
```

**2. Order í…Œì´ë¸”**

```sql
-- ì¶”ê°€ í•„ìš” í•„ë“œ (ë¸Œëœë“œë³„ ì£¼ë¬¸ ì¶”ì )
brandId          Int?           -- ì£¼ë¬¸ì˜ ì£¼ìš” ë¸Œëœë“œ
totalCommission  Float?         -- ë¸Œëœë“œ ìˆ˜ìˆ˜ë£Œ
settlementStatus SettlementStatus @default(PENDING)
```

### ğŸ†• ì‹ ê·œ ì¶”ê°€ í•„ìš” í…Œì´ë¸”

#### **1. Brand í…Œì´ë¸” (í•µì‹¬)**

```sql
model Brand {
  id              Int           @id @default(autoincrement())
  name            String        @unique           -- ë¸Œëœë“œëª…
  slug            String        @unique           -- URLìš© ìŠ¬ëŸ¬ê·¸
  logoUrl         String?                         -- ë¸Œëœë“œ ë¡œê³ 
  description     String?                         -- ë¸Œëœë“œ ì†Œê°œ
  businessNumber  String?       @unique           -- ì‚¬ì—…ìë²ˆí˜¸

  -- ë¸Œëœë“œ ìƒíƒœ
  status          BrandStatus   @default(PENDING) -- ìŠ¹ì¸ ìƒíƒœ
  isActive        Boolean       @default(true)    -- í™œì„±í™” ìƒíƒœ

  -- ì •ì‚° ì •ë³´
  commissionRate  Float         @default(5.0)     -- ìˆ˜ìˆ˜ë£Œìœ¨ (%)
  bankAccount     String?                         -- ì •ì‚° ê³„ì¢Œ
  bankCode        String?                         -- ì€í–‰ ì½”ë“œ
  accountHolder   String?                         -- ì˜ˆê¸ˆì£¼

  -- ë¸Œëœë“œ ì„¤ì •
  settings        Json?                           -- ë¸Œëœë“œë³„ ì„¤ì • (JSON)

  -- ê´€ê³„
  users           User[]                          -- ë¸Œëœë“œ ê´€ë¦¬ìë“¤ (1:N)
  products        Product[]                       -- ë¸Œëœë“œ ìƒí’ˆë“¤
  settlements     Settlement[]                    -- ì •ì‚° ë‚´ì—­

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

enum BrandStatus {
  PENDING        -- ìŠ¹ì¸ ëŒ€ê¸°
  APPROVED       -- ìŠ¹ì¸ ì™„ë£Œ
  REJECTED       -- ìŠ¹ì¸ ê±°ë¶€
  SUSPENDED      -- ì¼ì‹œ ì¤‘ë‹¨
}

enum ProductStatus {
  PENDING        -- ìŠ¹ì¸ ëŒ€ê¸°
  APPROVED       -- ìŠ¹ì¸ ì™„ë£Œ
  REJECTED       -- ìŠ¹ì¸ ê±°ë¶€
  DRAFT          -- ì„ì‹œ ì €ì¥
}
```

#### **2. UserGrade í…Œì´ë¸” (íšŒì›ë“±ê¸‰ ê´€ë¦¬)**

```sql
model UserGrade {
  id              Int           @id @default(autoincrement())
  name            String        @unique           -- ë“±ê¸‰ëª… (ì¼ë°˜, VIP, VVIP)
  slug            String        @unique           -- ë“±ê¸‰ ì½”ë“œ (normal, vip, vvip)
  description     String?                         -- ë“±ê¸‰ ì„¤ëª…

  -- í˜œíƒ ì„¤ì •
  discountRate    Float         @default(0)       -- ê¸°ë³¸ í• ì¸ìœ¨ (%)
  pointRate       Float         @default(1.0)     -- í¬ì¸íŠ¸ ì ë¦½ìœ¨ (ë°°ìˆ˜)
  freeShipping    Boolean       @default(false)   -- ë¬´ë£Œë°°ì†¡ ì—¬ë¶€

  -- ë“±ê¸‰ ì¡°ê±´
  minOrderAmount  Float         @default(0)       -- ìµœì†Œ ì£¼ë¬¸ ê¸ˆì•¡
  minOrderCount   Int           @default(0)       -- ìµœì†Œ ì£¼ë¬¸ íšŸìˆ˜

  -- ë“±ê¸‰ ê´€ë¦¬
  isActive        Boolean       @default(true)
  sortOrder       Int           @default(0)       -- ì •ë ¬ ìˆœì„œ

  users           User[]                          -- ì´ ë“±ê¸‰ì˜ ì‚¬ìš©ìë“¤

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}
```

#### **3. Settlement í…Œì´ë¸” (ì •ì‚° ê´€ë¦¬)**

```sql
model Settlement {
  id              String        @id @default(cuid())
  brand           Brand         @relation(fields: [brandId], references: [id])
  brandId         Int

  -- ì •ì‚° ê¸°ê°„
  periodStart     DateTime                        -- ì •ì‚° ì‹œì‘ì¼
  periodEnd       DateTime                        -- ì •ì‚° ì¢…ë£Œì¼
  settlementDate  DateTime?                       -- ì‹¤ì œ ì •ì‚°ì¼

  -- ê¸ˆì•¡ ê³„ì‚°
  totalSales      Float                           -- ì´ ë§¤ì¶œ
  totalOrders     Int                             -- ì´ ì£¼ë¬¸ ê±´ìˆ˜
  commission      Float                           -- ìˆ˜ìˆ˜ë£Œ
  commissionRate  Float                           -- ìˆ˜ìˆ˜ë£Œìœ¨
  adjustments     Float         @default(0)       -- ì¡°ì • ê¸ˆì•¡
  finalAmount     Float                           -- ìµœì¢… ì •ì‚° ê¸ˆì•¡

  -- ì •ì‚° ìƒíƒœ
  status          SettlementStatus @default(PENDING)

  -- ê³„ì¢Œ ì •ë³´ (ì •ì‚° ì‹œì )
  bankAccount     String?
  bankCode        String?
  accountHolder   String?

  -- ë©”ëª¨ ë° ì²¨ë¶€
  notes           String?                         -- ì •ì‚° ë©”ëª¨
  attachments     String[]                        -- ì²¨ë¶€ íŒŒì¼ URLs

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

enum SettlementStatus {
  PENDING         -- ì •ì‚° ëŒ€ê¸°
  PROCESSING      -- ì •ì‚° ì²˜ë¦¬ì¤‘
  COMPLETED       -- ì •ì‚° ì™„ë£Œ
  FAILED          -- ì •ì‚° ì‹¤íŒ¨
  CANCELLED       -- ì •ì‚° ì·¨ì†Œ
}
```

#### **4. BrandAnalytics í…Œì´ë¸” (í†µê³„ ë°ì´í„° ìºì‹œ)**

```sql
model BrandAnalytics {
  id              Int           @id @default(autoincrement())
  brand           Brand         @relation(fields: [brandId], references: [id])
  brandId         Int

  -- ë¶„ì„ ê¸°ê°„
  period          String                          -- 'YYYY-MM' or 'YYYY-MM-DD'
  periodType      PeriodType                      -- DAILY, MONTHLY, YEARLY

  -- ë§¤ì¶œ ì§€í‘œ
  totalRevenue    Float         @default(0)
  totalOrders     Int           @default(0)
  totalProducts   Int           @default(0)
  averageOrderValue Float       @default(0)

  -- ìƒí’ˆ ì§€í‘œ
  bestSellingProduct String?                      -- ë² ìŠ¤íŠ¸ì…€ëŸ¬ ìƒí’ˆ ID
  totalProductViews  Int        @default(0)
  conversionRate     Float      @default(0)

  -- ê¸°íƒ€ ì§€í‘œ
  returnsCount    Int           @default(0)
  refundsAmount   Float         @default(0)
  reviewsCount    Int           @default(0)
  averageRating   Float         @default(0)

  calculatedAt    DateTime      @default(now())

  @@unique([brandId, period, periodType])
}

enum PeriodType {
  DAILY
  MONTHLY
  YEARLY
}
```

#### **5. TermsAgreement í…Œì´ë¸” (ì•½ê´€ ë™ì˜ ê´€ë¦¬)**

```sql
model TermsAgreement {
  id              Int           @id @default(autoincrement())
  user            User          @relation(fields: [userId], references: [id])
  userId          String

  -- ì•½ê´€ ì •ë³´
  termsType       TermsType                       -- ì•½ê´€ ì¢…ë¥˜
  termsVersion    String                          -- ì•½ê´€ ë²„ì „
  content         String?                         -- ì•½ê´€ ë‚´ìš© (ìš”ì•½)

  -- ë™ì˜ ì •ë³´
  isAgreed        Boolean                         -- ë™ì˜ ì—¬ë¶€
  agreedAt        DateTime?                       -- ë™ì˜ ì¼ì‹œ
  ipAddress       String?                         -- ë™ì˜ IP
  userAgent       String?                         -- ë™ì˜ ë¸Œë¼ìš°ì €

  -- ì² íšŒ ì •ë³´
  isWithdrawn     Boolean       @default(false)   -- ë™ì˜ ì² íšŒ ì—¬ë¶€
  withdrawnAt     DateTime?                       -- ì² íšŒ ì¼ì‹œ
  withdrawReason  String?                         -- ì² íšŒ ì‚¬ìœ 

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@unique([userId, termsType, termsVersion])
}

enum TermsType {
  SERVICE         -- ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€
  PRIVACY         -- ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨
  MARKETING       -- ë§ˆì¼€íŒ… ìˆ˜ì‹  ë™ì˜
  LOCATION        -- ìœ„ì¹˜ì •ë³´ ì´ìš©ì•½ê´€
  THIRDPARTY      -- ì œ3ì ì •ë³´ì œê³µ ë™ì˜
}
```

#### **6. UserLog í…Œì´ë¸” (ì‚¬ìš©ì í™œë™ ë¡œê·¸)**

```sql
model UserLog {
  id              String        @id @default(cuid())
  user            User?         @relation(fields: [userId], references: [id])
  userId          String?                         -- ë¹„íšŒì› ë¡œê·¸ë„ ê¸°ë¡ ê°€ëŠ¥

  -- í™œë™ ì •ë³´
  action          LogAction                       -- í™œë™ ì¢…ë¥˜
  category        String?                         -- ì¹´í…Œê³ ë¦¬ (auth, order, product ë“±)
  description     String?                         -- í™œë™ ì„¤ëª…

  -- ëŒ€ìƒ ì •ë³´
  targetType      String?                         -- ëŒ€ìƒ íƒ€ì… (Product, Order ë“±)
  targetId        String?                         -- ëŒ€ìƒ ID

  -- ì„¸ì…˜ ì •ë³´
  sessionId       String?                         -- ì„¸ì…˜ ID
  ipAddress       String?                         -- IP ì£¼ì†Œ
  userAgent       String?                         -- ë¸Œë¼ìš°ì € ì •ë³´

  -- ì¶”ê°€ ë°ì´í„°
  metadata        Json?                           -- ì¶”ê°€ ë©”íƒ€ë°ì´í„° (JSON)

  -- ê²°ê³¼ ì •ë³´
  isSuccess       Boolean       @default(true)    -- ì„±ê³µ ì—¬ë¶€
  errorMessage    String?                         -- ì—ëŸ¬ ë©”ì‹œì§€

  createdAt       DateTime      @default(now())

  @@index([userId, createdAt])
  @@index([action, createdAt])
}

enum LogAction {
  LOGIN           -- ë¡œê·¸ì¸
  LOGOUT          -- ë¡œê·¸ì•„ì›ƒ
  REGISTER        -- íšŒì›ê°€ì…
  PASSWORD_RESET  -- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •

  VIEW_PRODUCT    -- ìƒí’ˆ ì¡°íšŒ
  ADD_TO_CART     -- ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€
  REMOVE_FROM_CART -- ì¥ë°”êµ¬ë‹ˆ ì œê±°

  CREATE_ORDER    -- ì£¼ë¬¸ ìƒì„±
  CANCEL_ORDER    -- ì£¼ë¬¸ ì·¨ì†Œ
  PAYMENT_SUCCESS -- ê²°ì œ ì„±ê³µ
  PAYMENT_FAIL    -- ê²°ì œ ì‹¤íŒ¨

  WRITE_REVIEW    -- ë¦¬ë·° ì‘ì„±
  UPDATE_PROFILE  -- í”„ë¡œí•„ ìˆ˜ì •

  BUSINESS_LOGIN  -- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œê·¸ì¸
  BUSINESS_ACTION -- ë¹„ì¦ˆë‹ˆìŠ¤ í™œë™
}
```

### ğŸ”„ ê¸°ì¡´ í…Œì´ë¸” ìˆ˜ì •ì‚¬í•­

#### **1. User í…Œì´ë¸” ìˆ˜ì •**

```sql
model User {
  // ... ê¸°ì¡´ í•„ë“œë“¤

  -- ë¸Œëœë“œ ê´€ë ¨ ì¶”ê°€ (1:1 ê´€ê³„ë¡œ ë‹¨ìˆœí™”)
  brandId         Int?                            -- ì†Œì† ë¸Œëœë“œ (nullable)
  brand           Brand?        @relation(fields: [brandId], references: [id])

  -- íšŒì›ë“±ê¸‰ ì¶”ê°€
  gradeId         Int?                            -- íšŒì›ë“±ê¸‰
  grade           UserGrade?    @relation(fields: [gradeId], references: [id])

  -- ë¹„ì¦ˆë‹ˆìŠ¤ ì¶”ê°€ ì •ë³´
  businessProfile Json?                           -- ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œí•„ (JSON)
  lastBusinessLogin DateTime?                     -- ë§ˆì§€ë§‰ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œê·¸ì¸

  -- ìƒˆë¡œìš´ ê´€ê³„ ì¶”ê°€
  termsAgreements TermsAgreement[]                -- ì•½ê´€ ë™ì˜ ë‚´ì—­
  userLogs        UserLog[]                       -- ì‚¬ìš©ì í™œë™ ë¡œê·¸
}
```

#### **2. Product í…Œì´ë¸” ìˆ˜ì •**

```sql
model Product {
  // ... ê¸°ì¡´ í•„ë“œë“¤

  -- storeName í•„ë“œ ì œê±° (product.brand.nameìœ¼ë¡œ ì ‘ê·¼)
  -- ë¸Œëœë“œ ì—°ê²° (í•„ìˆ˜ë¡œ ë³€ê²½ ì˜ˆì •)
  brandId         Int                              -- ë¸Œëœë“œ ì—°ê²° (í•„ìˆ˜)
  brand           Brand         @relation(fields: [brandId], references: [id])

  -- ì¶”ê°€ í•„ë“œ
  status          ProductStatus @default(PENDING)  -- ì‹ ê·œ ìƒí’ˆì€ ìŠ¹ì¸ ëŒ€ê¸°
  detailedDescription String?                      -- Tiptap HTML ì¶œë ¥
  sku             String?       @unique             -- ìƒí’ˆ ì½”ë“œ

  -- ë¸Œëœë“œ ê´€ë ¨ í†µê³„
  totalSales      Float         @default(0)         -- ëˆ„ì  íŒë§¤ì•¡
  totalSold       Int           @default(0)         -- ëˆ„ì  íŒë§¤ëŸ‰

  -- ìŠ¹ì¸ ê´€ë ¨
  approvedAt      DateTime?                        -- ìŠ¹ì¸ ì¼ì‹œ
  approvedBy      String?                          -- ìŠ¹ì¸ì ID
  rejectionReason String?                          -- ê±°ë¶€ ì‚¬ìœ 
}
```

#### **3. Order í…Œì´ë¸” ìˆ˜ì •**

```sql
model Order {
  // ... ê¸°ì¡´ í•„ë“œë“¤

  -- ë¸Œëœë“œ ê´€ë ¨ ì¶”ê°€
  brandId         Int?                             -- ì£¼ìš” ë¸Œëœë“œ (ë‹¨ì¼ ë¸Œëœë“œ ì£¼ë¬¸ìš©)
  brand           Brand?        @relation(fields: [brandId], references: [id])

  -- ì •ì‚° ê´€ë ¨
  totalCommission Float?                           -- ì´ ìˆ˜ìˆ˜ë£Œ
  settlementStatus SettlementStatus @default(PENDING)
  settlementId    String?                          -- ì •ì‚° ID ì—°ê²°
  settlement      Settlement?   @relation(fields: [settlementId], references: [id])
}
```

## ğŸ”§ API êµ¬ì¡° ì„¤ê³„

### **1. ë¸Œëœë“œ ê´€ë¦¬ API**

```typescript
// GET /api/business/brand
// í˜„ì¬ ì‚¬ìš©ìì˜ ë¸Œëœë“œ ì •ë³´ ì¡°íšŒ

// PUT /api/business/brand
// ë¸Œëœë“œ ì •ë³´ ìˆ˜ì • (ì´ë¦„, ë¡œê³ , ì„¤ëª…)

// POST /api/business/brand/logo
// ë¸Œëœë“œ ë¡œê³  ì—…ë¡œë“œ
```

### **2. ìƒí’ˆ ê´€ë¦¬ API**

```typescript
// GET /api/business/products
// ë¸Œëœë“œë³„ ìƒí’ˆ ëª©ë¡ (í˜ì´ì§€ë„¤ì´ì…˜, í•„í„°ë§)

// POST /api/business/products
// ìƒˆ ìƒí’ˆ ë“±ë¡ (ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœë¡œ)

// PUT /api/business/products/[id]
// ìƒí’ˆ ì •ë³´ ìˆ˜ì •

// DELETE /api/business/products/[id]
// ìƒí’ˆ ì‚­ì œ (soft delete)

// GET /api/business/products/inventory
// ì¬ê³  í˜„í™© ì¡°íšŒ

// PUT /api/business/products/[id]/inventory
// ì¬ê³  ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸
```

### **3. ì£¼ë¬¸ ê´€ë¦¬ API**

```typescript
// GET /api/business/orders
// ë¸Œëœë“œë³„ ì£¼ë¬¸ ëª©ë¡

// PUT /api/business/orders/[id]/status
// ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ (ì¤€ë¹„ì¤‘, ë°°ì†¡ì¤‘ ë“±)

// GET /api/business/orders/[id]
// ì£¼ë¬¸ ìƒì„¸ ì •ë³´
```

### **4. ì •ì‚° ê´€ë¦¬ API**

```typescript
// GET /api/business/settlement
// ì •ì‚° ë‚´ì—­ ì¡°íšŒ

// POST /api/business/settlement/request
// ì •ì‚° ì‹ ì²­

// GET /api/business/settlement/calculate
// ì •ì‚° ì˜ˆìƒ ê¸ˆì•¡ ê³„ì‚°

// PUT /api/business/settlement/account
// ì •ì‚° ê³„ì¢Œ ì •ë³´ ìˆ˜ì •
```

### **5. í†µê³„ ë¶„ì„ API**

```typescript
// GET /api/business/analytics/sales
// ë§¤ì¶œ ë¶„ì„ ë°ì´í„°

// GET /api/business/analytics/products
// ìƒí’ˆ ë¶„ì„ ë°ì´í„°

// GET /api/business/analytics/dashboard
// ëŒ€ì‹œë³´ë“œ ìš”ì•½ í†µê³„
```

## ğŸš€ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

### **1ë‹¨ê³„: í•µì‹¬ í…Œì´ë¸” ìƒì„±**

```sql
-- 1. Brand, UserGrade, TermsAgreement, UserLog í…Œì´ë¸” ìƒì„±
-- 2. ê¸°ì¡´ Productì˜ storeNameì„ ê¸°ë°˜ìœ¼ë¡œ Brand ë°ì´í„° ìƒì„±
-- 3. isBusiness=true ì‚¬ìš©ìë“¤ì˜ brandId ì—°ê²° (1:1 ê´€ê³„)
-- 4. ê¸°ë³¸ íšŒì›ë“±ê¸‰ ë°ì´í„° ìƒì„± (ì¼ë°˜, VIP, VVIP)
```

### **2ë‹¨ê³„: ì ì§„ì  ì´ê´€**

```sql
-- 1. Product í…Œì´ë¸”ì— brandId ì¶”ê°€ (nullable)
-- 2. ê¸°ì¡´ ìƒí’ˆë“¤ì˜ brandId ì—…ë°ì´íŠ¸
-- 3. ì‹ ê·œ ìƒí’ˆë¶€í„° ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì ìš©
```

### **3ë‹¨ê³„: ì •ì‚° ì‹œìŠ¤í…œ êµ¬ì¶•**

```sql
-- 1. Settlement í…Œì´ë¸” í™œìš©í•œ ì •ì‚° ë¡œì§ êµ¬í˜„
-- 2. ê¸°ì¡´ ì£¼ë¬¸ë“¤ì˜ ìˆ˜ìˆ˜ë£Œ ê³„ì‚° ë° ì´ê´€
-- 3. ì •ì‚° ì‹ ì²­/ì²˜ë¦¬ í”„ë¡œì„¸ìŠ¤ êµ¬ì¶•
```

## ğŸ” ë³´ì•ˆ ë° ê¶Œí•œ ê´€ë¦¬

### **1. ë¸Œëœë“œë³„ ë°ì´í„° ê²©ë¦¬**

```typescript
// ì‚¬ìš©ìì˜ ë¸Œëœë“œ ì†Œì† í™•ì¸ (ë‹¨ìˆœí™”ëœ 1:1 ê´€ê³„)
const user = await prisma.user.findUnique({
  where: { id: userId },
  include: { brand: true },
});

if (!user?.isBusiness || !user.brand || user.brandId !== targetBrandId) {
  throw new UnauthorizedError();
}
```

### **2. íšŒì›ë“±ê¸‰ ê¸°ë°˜ í˜œíƒ ì œì–´**

```typescript
// íšŒì›ë“±ê¸‰ë³„ í˜œíƒ ì ìš©
const user = await prisma.user.findUnique({
  where: { id: userId },
  include: { grade: true },
});

// grade.discountRate: ê¸°ë³¸ í• ì¸ìœ¨
// grade.pointRate: í¬ì¸íŠ¸ ì ë¦½ìœ¨
// grade.freeShipping: ë¬´ë£Œë°°ì†¡ ì—¬ë¶€
const finalPrice = calculatePriceWithGrade(basePrice, user.grade);
```

### **3. í™œë™ ë¡œê·¸ ê¸°ë¡**

```typescript
// ì¤‘ìš” í™œë™ ìë™ ë¡œê¹…
await prisma.userLog.create({
  data: {
    userId,
    action: "BUSINESS_ACTION",
    category: "product",
    description: "ìƒí’ˆ ë“±ë¡",
    targetType: "Product",
    targetId: productId,
    ipAddress,
    userAgent,
    metadata: { productData: sanitizedData },
  },
});
```

## ğŸ“Š ì„±ëŠ¥ ìµœì í™”

### **1. ì¸ë±ìŠ¤ ì„¤ê³„**

```sql
-- ë¸Œëœë“œë³„ ìƒí’ˆ ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_product_brand_status ON Product(brandId, status);

-- ë¸Œëœë“œë³„ ì£¼ë¬¸ ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_order_brand_date ON Order(brandId, createdAt);

-- ì •ì‚° ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_settlement_brand_period ON Settlement(brandId, periodStart, periodEnd);
```

### **2. í†µê³„ ë°ì´í„° ìºì‹±**

```typescript
// BrandAnalytics í…Œì´ë¸”ì„ í†µí•œ ì‚¬ì „ ê³„ì‚°ëœ í†µê³„
// ì¼ë³„/ì›”ë³„ ë°°ì¹˜ ì‘ì—…ìœ¼ë¡œ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸
// Redis ìºì‹±ìœ¼ë¡œ ì‹¤ì‹œê°„ ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ
```

## ğŸ¯ í–¥í›„ ê°œë°œ ë¡œë“œë§µ

### **Phase 1: í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ (4ì£¼)**

- [ ] ë¸Œëœë“œ DB ìŠ¤í‚¤ë§ˆ êµ¬ì¶• (Brand, UserGrade, TermsAgreement, UserLog)
- [ ] íšŒì›ë“±ê¸‰ ì‹œìŠ¤í…œ êµ¬í˜„ (í• ì¸ìœ¨, í¬ì¸íŠ¸, ë¬´ë£Œë°°ì†¡)
- [ ] ë¸Œëœë“œ ì„¤ì • í˜ì´ì§€ ì™„ì„± (1:1 ê´€ê³„ë¡œ ë‹¨ìˆœí™”)
- [ ] ìƒí’ˆ ê´€ë¦¬ API ì—°ë™ (ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ í¬í•¨)
- [ ] ê¸°ë³¸ í†µê³„ ëŒ€ì‹œë³´ë“œ
- [ ] í™œë™ ë¡œê·¸ ì‹œìŠ¤í…œ êµ¬ì¶•

### **Phase 2: ì£¼ë¬¸ ë° ì •ì‚° (4ì£¼)**

- [ ] ì£¼ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] ì •ì‚° ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] ë°°ì†¡ ê´€ë¦¬ ê¸°ëŠ¥
- [ ] í™˜ë¶ˆ ì²˜ë¦¬ ê¸°ëŠ¥

### **Phase 3: ê³ ë„í™” (4ì£¼)**

- [ ] ê³ ê¸‰ í†µê³„ ë¶„ì„
- [ ] ë¸Œëœë“œë³„ í”„ë¡œëª¨ì…˜
- [ ] ëª¨ë°”ì¼ ìµœì í™”
- [ ] ì•Œë¦¼ ì‹œìŠ¤í…œ

### **Phase 4: í™•ì¥ ê¸°ëŠ¥ (ì¶”í›„)**

- [ ] ë‹¤ì¤‘ ë¸Œëœë“œ ê´€ë¦¬
- [ ] API ì™¸ë¶€ ì—°ë™
- [ ] AI ê¸°ë°˜ ìƒí’ˆ ì¶”ì²œ
- [ ] ê¸€ë¡œë²Œ ì§„ì¶œ ì§€ì›

---

**ğŸ’¡ ì°¸ê³ ì‚¬í•­**:

- í˜„ì¬ ì‹œìŠ¤í…œì€ Mock ë°ì´í„°ë¡œ êµ¬ë™ë¨
- **ë‹¨ìˆœí™”ëœ êµ¬ì¡°**: BrandUser í…Œì´ë¸” ì œê±°, User-Brand 1:1 ê´€ê³„ë¡œ ë³€ê²½
- **storeName í•„ë“œ ì œê±°**: product.brand.nameìœ¼ë¡œ ì ‘ê·¼í•˜ì—¬ ì¤‘ë³µ ì œê±°
- **ìƒˆë¡œìš´ ê¸°ëŠ¥**: íšŒì›ë“±ê¸‰ ì‹œìŠ¤í…œ, ì•½ê´€ ë™ì˜ ê´€ë¦¬, í™œë™ ë¡œê·¸ ì‹œìŠ¤í…œ
- ì ì§„ì  ì´ê´€ ì „ëµì„ í†µí•´ ê¸°ì¡´ ë°ì´í„° ì†ì‹¤ ì—†ì´ ê°œì„  ê°€ëŠ¥
